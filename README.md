# LMArenaImagenAutomator
![Image](https://github.com/user-attachments/assets/0a887137-64c3-4919-8ab6-b5cf23e5f751)

## ğŸ“ é¡¹ç›®ç®€ä»‹

LMArenaImagenAutomator æ˜¯ä¸€ä¸ªåŸºäº Playwright + Camoufox çš„è‡ªåŠ¨åŒ–å›¾åƒç”Ÿæˆå·¥å…·ï¼Œé€šè¿‡æ¨¡æ‹Ÿäººç±»æ“ä½œä¸ LMArenaã€Gemini ç­‰ç½‘ç«™äº¤äº’æä¾›å›¾åƒç”ŸæˆæœåŠ¡åˆ°OpenAIæ ¼å¼çš„æ¥å£ã€‚

å½“å‰æ”¯æŒçš„ç½‘ç«™ï¼š
  - LMArena
  - Gemini Enterprise Business
  - Nano Banana Free
  - æœªæ¥å¯èƒ½æ”¯æŒæ›´å¤šç½‘ç«™...

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ¤– **æ‹Ÿäººæ“ä½œ**ï¼šæ¨¡æ‹Ÿäººç±»æ‰“å­—è¡Œä¸ºå’Œé¼ æ ‡ç§»åŠ¨è¡Œä¸º
- ğŸ–¼ï¸ **å¤šå›¾æ”¯æŒ**ï¼šæœ€å¤šæ”¯æŒåŒæ—¶ä¸Šä¼  10 å¼ å‚è€ƒå›¾ç‰‡
- ğŸ“Š **é˜Ÿåˆ—ç®¡ç†**ï¼šæ”¯æŒä»»åŠ¡é˜Ÿåˆ—ï¼Œé˜²æ­¢è¯·æ±‚è¿‡è½½æˆ–è¶…æ—¶
- ğŸŒ **ä»£ç†æ”¯æŒ**ï¼šæ”¯æŒ HTTP å’Œ SOCKS5 ä»£ç†é…ç½®
- ğŸ­ **ç‰¹å¾ä¼ªè£…**ï¼šå°½é‡ä¼ªè£…æˆéè‡ªåŠ¨ç¨‹åºæ§åˆ¶çš„æµè§ˆå™¨
- ğŸ”— **æµå¼ä¿æ´»**ï¼šå¤ç”¨æ ‡å‡†æ¥å£çš„æµå¼æ¨¡å¼å‘é€å¿ƒè·³åŒ…

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚

- **Node.js**: v20.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ (éœ€ ABI 115+)
- **æ“ä½œç³»ç»Ÿ**: Windows / Linux / macOS
- **è¿è¡Œç¯å¢ƒ**: Camoufox (åŸºäº Firefox çš„åæŒ‡çº¹æ£€æµ‹æµè§ˆå™¨)

> **å¼€å‘ç¯å¢ƒå‚è€ƒ**
> - Windows 10: Node.js v22.20.0
> - Debian 12: Node.js v20.19.0

### å®‰è£…æ­¥éª¤

1. **è·å–é¡¹ç›®**
   å…‹éš†ä»£ç ä»“åº“æˆ–ä¸‹è½½æºç è§£å‹ã€‚

2. **å‡†å¤‡é…ç½®**
   å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼š
   ```bash
   cp config.example.yaml config.yaml
   ```

3. **å®‰è£…ä¾èµ–**
   ```bash
   # å®‰è£…åŸºç¡€ä¾èµ–
   pnpm install

   # åˆå§‹åŒ–ç¯å¢ƒ (ä¸‹è½½æµè§ˆå™¨åŠé¢„ç¼–è¯‘æ–‡ä»¶)
   # âš ï¸ è‹¥æ— æ³•è¿æ¥ GitHubï¼Œè¯·å…ˆåœ¨ config.yaml ä¸­é…ç½®ä»£ç†
   npm run init
   ```

4. **å¯åŠ¨æœåŠ¡**
   ```bash
   # ç™»å½•æ¨¡å¼ (é¦–æ¬¡ä½¿ç”¨æ¨èï¼Œç”¨äºæ‰‹åŠ¨ç™»å½•)
   npm start -- -login

   # æ ‡å‡†æ¨¡å¼
   npm start

   # Linuxåˆ›å»ºè™šæ‹Ÿæ˜¾ç¤ºå™¨åˆ°VNC
   npm start -- -xvfb -vnc
   ```

5. **æ¥å£æµ‹è¯• (å¯é€‰)**
   ```bash
   npm test
   ```
---

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### âš ï¸ é¦–æ¬¡ä½¿ç”¨å¿…è¯»

1. **é¦–æ¬¡å¯åŠ¨**ï¼š
   - è¯·ä½¿ç”¨ `npm start -- -login` è¿›å…¥ç™»å½•æ¨¡å¼ï¼ˆå…³é—­æ— å¤´æ¨¡å¼ï¼‰ã€‚
   - Linuxç”¨æˆ·ä½¿ç”¨ `npm start -- -xvfb -vnc` è¿›å…¥ç™»å½•æ¨¡å¼ä¸”åˆ›å»ºè™šæ‹Ÿæ˜¾ç¤ºå™¨åˆ°VNCã€‚
2. **å®Œæˆåˆå§‹åŒ–**ï¼š
   - æ‰‹åŠ¨ç™»å½•è´¦å·ã€‚
   - åœ¨è¾“å…¥æ¡†å‘é€ä»»æ„æ¶ˆæ¯ï¼Œè§¦å‘å¹¶å®Œæˆ CloudFlare/reCAPTCHA éªŒè¯åŠæœåŠ¡æ¡æ¬¾åŒæ„ã€‚
3. **è¿è¡Œå»ºè®®**ï¼šåˆå§‹åŒ–å®Œæˆåå¯åˆ‡æ¢å›æ ‡å‡†æ¨¡å¼ï¼Œä½†ä¸ºé™ä½é£æ§ï¼Œ**å¼ºçƒˆå»ºè®®é•¿æœŸä¿æŒéæ— å¤´æ¨¡å¼è¿è¡Œ**ã€‚


### æ¥å£ä½¿ç”¨è¯´æ˜

#### 1. OpenAI å…¼å®¹æ¥å£

> [!WARNING]
> **å¹¶å‘é™åˆ¶ä¸æµå¼ä¿æ´»å»ºè®®**
> æœ¬é¡¹ç›®é€šè¿‡æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨æ“ä½œå®ç°ï¼Œ**å¿…é¡»ä¸²è¡Œå¤„ç†ä»»åŠ¡**ï¼Œå¹¶å‘è¯·æ±‚å°†è¿›å…¥é˜Ÿåˆ—ã€‚ä¸ºé˜²æ­¢æ’é˜Ÿè¿‡ä¹…å¯¼è‡´å®¢æˆ·ç«¯è¶…æ—¶ï¼Œå½“ç§¯å‹ä»»åŠ¡è¾¾åˆ° 3 ä¸ªæ—¶å°†æ‹’ç»æ–°è¯·æ±‚ã€‚
> 
> **ğŸ’¡ å¼ºçƒˆå»ºè®®å¼€å¯æµå¼æ¨¡å¼**ï¼šæœåŠ¡å™¨å°†å‘é€ä¿æ´»å¿ƒè·³åŒ…ï¼Œæœ‰æ•ˆé¿å…å› æ’é˜Ÿç­‰å¾…é€ æˆçš„è¿æ¥è¶…æ—¶ã€‚

**è¯·æ±‚ç«¯ç‚¹**
```
POST http://127.0.0.1:3000/v1/chat/completions
```

<details>
<summary>ğŸ“„ æŸ¥çœ‹APIè¯·æ±‚ç¤ºä¾‹</summary>

**è¯·æ±‚ç¤ºä¾‹ï¼ˆéæµå¼ï¼‰**
```bash
curl -X POST http://127.0.0.1:3000/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-secret-key" \
  -d '{
    "model": "gemini-3-pro-image-preview",
    "messages": [
      {
        "role": "user",
        "content": [
          {
            "type": "text",
            "text": "generate a cat"
          }
      ]
      }
    ]
  }'
```

**å“åº”æ ¼å¼ï¼ˆéæµå¼ï¼‰**
```json
{
  "id": "chatcmpl-1732374740123",
  "object": "chat.completion",
  "created": 1732374740,
  "model": "gemini-3-pro-image-preview",
  "choices": [{
    "index": 0,
    "message": {
      "role": "assistant",
      "content": "![generated](data:image/jpeg;base64,/9j/4AAQ...)"
    },
    "finish_reason": "stop"
  }]
}
```

**è¯·æ±‚ç¤ºä¾‹ï¼ˆæµå¼ - æ¨èï¼‰**
```bash
curl -X POST http://127.0.0.1:3000/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-secret-key" \
  -d '{
    "model": "gemini-3-pro-image-preview",
    "stream": true,
    "messages": [
      {
        "role": "user",
        "content": "generate a cat"
      }
    ]
  }'
```

**å“åº”æ ¼å¼ï¼ˆæµå¼ï¼‰**
```
data: {"id":"chatcmpl-1732374740123","object":"chat.completion.chunk","created":1732374740,"model":"gemini-3-pro-image-preview","choices":[{"index":0,"delta":{"role":"assistant","content":""},"finish_reason":null}]}

: keep-alive
: keep-alive

data: {"id":"chatcmpl-1732374740123","object":"chat.completion.chunk","created":1732374740,"model":"gemini-3-pro-image-preview","choices":[{"index":0,"delta":{"content":"![generated](data:image/jpeg;base64,/9j/4AAQ...)"},"finish_reason":"stop"}]}

data: [DONE]
```
</details>

#### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ |
| :--- | :--- |
| **model** | **å¿…å¡«**ã€‚æŒ‡å®šä½¿ç”¨çš„æ¨¡å‹åç§°ï¼ˆå¦‚ `gemini-3-pro-image-preview`ï¼‰ã€‚<br>å¯é€šè¿‡ `/v1/models` æ¥å£æˆ–æŸ¥çœ‹ `lib/backend/models.js` è·å–å®Œæ•´åˆ—è¡¨ã€‚ |
| **stream** | **æ¨èå¼€å¯**ã€‚æµå¼å“åº”åŒ…å«å¿ƒè·³ä¿æ´»æœºåˆ¶ï¼Œé˜²æ­¢ç”Ÿæˆè€—æ—¶è¿‡é•¿å¯¼è‡´è¿æ¥è¶…æ—¶ã€‚ |

> **ğŸ’¡ å…³äºæµå¼ä¿æ´»ï¼ˆHeartbeatï¼‰**
>
> ä¸ºé˜²æ­¢é•¿è¿æ¥è¶…æ—¶ï¼Œç³»ç»Ÿæä¾›ä¸¤ç§ä¿æ´»æ¨¡å¼ï¼ˆå¯åœ¨é…ç½®ä¸­åˆ‡æ¢ï¼‰ï¼š
> 1. **Comment æ¨¡å¼ï¼ˆé»˜è®¤/æ¨èï¼‰**ï¼šå‘é€ `:keepalive` æ³¨é‡Šã€‚ç¬¦åˆ SSE æ ‡å‡†ï¼Œå…¼å®¹æ€§æœ€å¥½ã€‚
> 2. **Content æ¨¡å¼**ï¼šå‘é€ç©ºå†…å®¹çš„ data åŒ…ã€‚ä»…ç”¨äºå¿…é¡»æ”¶åˆ° JSON æ•°æ®æ‰é‡ç½®è¶…æ—¶çš„ç‰¹æ®Šå®¢æˆ·ç«¯ã€‚

#### 2. è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨

**è¯·æ±‚ç«¯ç‚¹**
```
GET http://127.0.0.1:3000/v1/models
```

<details>
<summary>ğŸ“„ æŸ¥çœ‹APIè¯·æ±‚ç¤ºä¾‹</summary>

**è¯·æ±‚ç¤ºä¾‹**
```bash
curl -X GET http://127.0.0.1:3000/v1/models \
  -H "Authorization: Bearer your-secret-key"
```

**å“åº”æ ¼å¼**
```json
{
  "object": "list",
  "data": [
    {
      "id": "seedream-4-high-res-fal",
      "object": "model",
      "created": 1732456789,
      "owned_by": "lmarena"
    },
    {
      "id": "gemini-3-pro-image-preview",
      "object": "model",
      "created": 1732456789,
      "owned_by": "lmarena"
    }
  ]
}
```

</details>

#### 3. å¤šæ¨¡æ€è¯·æ±‚ (å›¾ç”Ÿå›¾/å›¾ç”Ÿæ–‡)

**åŠŸèƒ½è¯´æ˜**ï¼šæ”¯æŒåœ¨æ¶ˆæ¯ä¸­é™„å¸¦å›¾ç‰‡è¿›è¡Œå¯¹è¯æˆ–ç”Ÿæˆã€‚

| é™åˆ¶é¡¹ | è¯´æ˜ |
| :--- | :--- |
| **æ”¯æŒæ ¼å¼** | PNG, JPEG, GIF, WebP |
| **æ•°é‡é™åˆ¶** | æœ€å¤§ä¸º10ï¼Œä½†æ ¹æ®ä¸åŒç½‘ç«™æœ‰ä¸åŒå‡ºå…¥ |
| **æ•°æ®æ ¼å¼** | å¿…é¡»ä½¿ç”¨ Base64 Data URL æ ¼å¼ (å¦‚ `data:image/jpeg;base64,...`) |
| **è‡ªåŠ¨è½¬æ¢** | ä¸ºä¿è¯å…¼å®¹æ€§ä¸ä¼ è¾“é€Ÿåº¦ï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨å°†æ‰€æœ‰å›¾ç‰‡è½¬æ¢ä¸º JPG æ ¼å¼ |

<details>
<summary>ğŸ“„ æŸ¥çœ‹APIè¯·æ±‚ç¤ºä¾‹</summary>

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "model": "gemini-3-pro-image-preview",
  "messages": [{
    "role": "user",
    "content": [
      {
        "type": "text",
        "text": "make it more colorful"
      },
      {
        "type": "image_url",
        "image_url": {
          "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAA..."
        }
      }
    ]
  }]
}
```

</details>

---

## ğŸ”§ å¸¸è§é—®é¢˜

<details>
<summary>âŒ è¯·æ±‚è¢«æ‹’ç» (429 Too Many Requests)</summary>

**é—®é¢˜**: å¹¶å‘è¯·æ±‚è¿‡å¤š

**è§£å†³æ–¹æ¡ˆ**:
- è¯¥é—®é¢˜ä»…å­˜åœ¨æœªå¼€å¯æµå¼ä¿æ´»æ—¶å‡ºç°
- é˜Ÿåˆ—é™åˆ¶ï¼š1 ä¸ªå¹¶å‘ + 2 ä¸ªæ’é˜Ÿ (æ€»è®¡ 3 ä¸ª)
- ä¿®æ”¹ `config.yaml` ä¸­çš„`queue.maxQueueSize` (ä¸å»ºè®®)
- ç­‰å¾…å½“å‰ä»»åŠ¡å®Œæˆåå†æäº¤æ–°ä»»åŠ¡

</details>

<details>
<summary>âŒ reCAPTCHA éªŒè¯å¤±è´¥</summary>

**é—®é¢˜**: è¿”å› `recaptcha validation failed`

**è§£å†³æ–¹æ¡ˆ**:
- è¿™æ˜¯ LMArena çš„äººæœºéªŒè¯æœºåˆ¶
- å»ºè®®ï¼š
  - é™ä½è¯·æ±‚é¢‘ç‡
  - é¦–æ¬¡ä½¿ç”¨æ—¶æ‰‹åŠ¨å®Œæˆä¸€æ¬¡éªŒè¯ (å…³é—­ headless æ¨¡å¼)
  - ä½¿ç”¨ç¨³å®šå’Œçº¯å‡€çš„ IP åœ°å€ (å¯ä½¿ç”¨ [ping0.cc](https://ping0.cc) æŸ¥è¯¢IPåœ°å€çº¯å‡€åº¦)

</details>

<details>
<summary>âŒ å›¾åƒç”Ÿæˆè¶…æ—¶</summary>

**é—®é¢˜**: ä»»åŠ¡è¶…è¿‡ 120 ç§’æœªå®Œæˆ

**è§£å†³æ–¹æ¡ˆ**:
- å¯ç”¨æµå¼ä¿æ´»ç¡®ä¿å®¢æˆ·ç«¯ä¸ä¼šä¸»åŠ¨æ–­å¼€è¿æ¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®š
- æŸäº›å¤æ‚æç¤ºè¯å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´

</details>

<details>
<summary>ğŸ§ ã€Linux ç¯å¢ƒä¸‹éæ— å¤´æ¨¡å¼è¿è¡Œã€‘</summary>

**é—®é¢˜**: éœ€è¦åœ¨ Linux æœåŠ¡å™¨ä¸Šæ˜¾ç¤ºæµè§ˆå™¨ç•Œé¢ï¼ˆå¦‚æ‰‹åŠ¨è¿‡éªŒè¯ç ï¼‰

**è§£å†³æ–¹æ¡ˆ**:

**æ–¹æ³•ä¸€ï¼šX11 è½¬å‘**
- æ¨èä½¿ç”¨ WindTerm ç­‰ç»ˆç«¯å·¥å…·ï¼Œå¼€å¯ X-Server åŠŸèƒ½
- åœ¨ SSH ä¼šè¯è®¾ç½®ä¸­å¯ç”¨ X11 è½¬å‘ (Forward X11)

**æ–¹æ³•äºŒï¼šXvfb + X11VNC (æ¨è)**
ä½¿ç”¨è™šæ‹Ÿæ˜¾ç¤ºå™¨è¿è¡Œç¨‹åºï¼Œå¹¶é€šè¿‡ VNC è¿œç¨‹æŸ¥çœ‹ã€‚

1. **ä½¿ç”¨å†…ç½®å‘½ä»¤å¯åŠ¨ (ç®€ä¾¿)**
   ```bash
   npm start -- -xvfb -vnc
   ```

2. **æ‰‹åŠ¨é…ç½®**
   å¦‚æœå†…ç½®å‘½ä»¤æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œå¯æ‰‹åŠ¨åˆ†æ­¥æ‰§è¡Œï¼š
   
   a. **å¯åŠ¨è™šæ‹Ÿæ˜¾ç¤ºå™¨å¹¶è¿è¡Œç¨‹åº** (å±å¹•å· 99 å¯æŒ‰éœ€ä¿®æ”¹):
      ```bash
      xvfb-run --server-num=99 --server-args="-ac -screen 0 1920x1080x24" npm start
      ```

   b. **å°†è™šæ‹Ÿæ˜¾ç¤ºå™¨æ˜ å°„è‡³ VNC**:
      ```bash
      x11vnc -display :99 -localhost -nopw -once -noxdamage -ncache 10 -forever
      ```

3. **å»ºç«‹ SSH éš§é“è¿æ¥ VNC** (å®‰å…¨æ¨è):
   ```bash
   # åœ¨æœ¬åœ°ç»ˆç«¯è¿è¡Œï¼Œå°†æœåŠ¡å™¨ 5900 ç«¯å£æ˜ å°„åˆ°æœ¬åœ°
   ssh -L 5900:127.0.0.1:5900 root@æœåŠ¡å™¨IP
   ```
   éšåä½¿ç”¨ VNC å®¢æˆ·ç«¯è¿æ¥ `127.0.0.1:5900` å³å¯ã€‚

</details>

---

## ğŸ“Š è®¾å¤‡é…ç½®å‚è€ƒ

| èµ„æº | æœ€ä½é…ç½® | æ¨èé…ç½® | 
| :--- | :--- | :--- | 
| **CPU** | 1 æ ¸ | 2 æ ¸åŠä»¥ä¸Š | 
| **å†…å­˜** | 1 GB | 2 GB åŠä»¥ä¸Š | 

**å®æµ‹ç¯å¢ƒè¡¨ç°**ï¼š
- **Oracle å…è´¹æœº** (1C1G, Debian 12)ï¼šèµ„æºç´§å¼ ï¼Œå¶æœ‰å¡é¡¿ï¼Œä»…ä¾›å°é²œæˆ–è½»åº¦ä½¿ç”¨ã€‚
- **é˜¿é‡Œäº‘è½»é‡äº‘** (2C2G, Debian 11)ï¼šè¿è¡Œæµç•…ç¨³å®šï¼Œä¸ºæœ¬é¡¹ç›®å¼€å‘æµ‹è¯•åŸºå‡†ç¯å¢ƒã€‚

## ğŸ“„ è®¸å¯è¯å’Œå…è´£å£°æ˜

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºã€‚

**å…è´£å£°æ˜**:
æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚å¦‚æœå› ä½¿ç”¨è¯¥é¡¹ç›®é€ æˆçš„ä»»ä½•åæœï¼ˆåŒ…æ‹¬ä½†ä¸ä»…é™äºè´¦å·è¢«ç¦ç”¨ï¼‰ï¼Œä½œè€…å’Œè¯¥é¡¹ç›®å‡ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚è¯·éµå®ˆç›¸å…³ç½‘ç«™å’ŒæœåŠ¡çš„ä½¿ç”¨æ¡æ¬¾ï¼Œä»¥åŠç›¸å…³æ•°æ®çš„å¤‡ä»½å·¥ä½œã€‚

---

## ğŸ“‹ æ›´æ–°æ—¥å¿—

æŸ¥çœ‹å®Œæ•´çš„ç‰ˆæœ¬å†å²å’Œæ›´æ–°å†…å®¹ï¼Œè¯·è®¿é—® [CHANGELOG.md](CHANGELOG.md)ã€‚

## ğŸ•°ï¸ å†å²ç‰ˆæœ¬è¯´æ˜

æœ¬é¡¹ç›®å·²ä» Puppeteer è¿ç§»è‡³ Camoufoxï¼Œä»¥åº”å¯¹æ—¥ç›Šå¤æ‚çš„åæœºå™¨äººæ£€æµ‹æœºåˆ¶ã€‚åŸºäº Puppeteer çš„æ—§ç‰ˆæœ¬ä»£ç å·²å½’æ¡£è‡³ `puppeteer-edition` åˆ†æ”¯ï¼Œä»…ä½œç•™å­˜ï¼Œ**ä¸å†æä¾›æ›´æ–°ä¸ç»´æŠ¤**ã€‚

---

**æ„Ÿè°¢ LMArena ã€Gemini ç­‰ç½‘ç«™æä¾›å›¾åƒç”ŸæˆæœåŠ¡ï¼** ğŸ‰
