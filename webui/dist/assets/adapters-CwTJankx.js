import{c as i,I as q,j as I,r as w,k as D,o as F,l as T,b as _,d as l,w as s,e as v,f as c,g as f,u as h,t as g,S as L,h as k,i as y,m as G,F as J}from"./index-BaE9FvKY.js";var Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zM464 544H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H212V612h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200z"}}]},name:"appstore",theme:"outlined"};function S(p){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},a=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),a.forEach(function(t){R(p,t,o[t])})}return p}function R(p,n,o){return n in p?Object.defineProperty(p,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):p[n]=o,p}var x=function(n,o){var a=S({},n,o.attrs);return i(q,S({},a,{icon:Q}),null)};x.displayName="AppstoreOutlined";x.inheritAttrs=!1;const W={style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"8px"}},X={style:{display:"flex","align-items":"center","min-width":"0",flex:"1"}},Y={style:{"font-weight":"600","font-size":"14px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Z={key:0,style:{"margin-bottom":"16px",padding:"12px",background:"#f5f5f5","border-radius":"6px",color:"#666","font-size":"13px","line-height":"1.6"}},K={key:1},ee={key:2},te={key:4,style:{"font-size":"12px",color:"#8c8c8c","margin-top":"4px"}},ne={style:{"text-align":"right"}},oe={__name:"adapters",setup(p){const n=I(),o=w(!1),a=w(null),t=D({});F(async()=>{await Promise.all([n.fetchAdaptersMeta(),n.fetchAdapterConfig()])});const O=T(()=>n.adaptersMeta),z=m=>{a.value=m;const r=n.adapterConfig[m.id]||{};Object.keys(t).forEach(u=>delete t[u]),m.configSchema&&m.configSchema.forEach(u=>{r[u.key]!==void 0?t[u.key]=r[u.key]:t[u.key]=u.default}),o.value=!0},C=async()=>{if(!a.value)return;const m={[a.value.id]:{...t}};await n.saveAdapterConfig(m)&&(o.value=!1)};return(m,r)=>{const u=c("a-button"),b=c("a-card"),V=c("a-list-item"),A=c("a-list"),U=c("a-empty"),H=c("a-input"),j=c("a-input-number"),M=c("a-switch"),P=c("a-select"),B=c("a-form-item"),E=c("a-form"),N=c("a-drawer"),$=c("a-layout");return l(),_($,{style:{background:"transparent"}},{default:s(()=>[i(b,{title:"适配器管理",bordered:!1},{extra:s(()=>[i(u,{type:"link",onClick:h(n).fetchAdaptersMeta},{default:s(()=>[...r[2]||(r[2]=[k("刷新列表",-1)])]),_:1},8,["onClick"])]),default:s(()=>[i(A,{grid:{gutter:16,xs:1,sm:2,md:3,lg:3,xl:4,xxl:4},"data-source":O.value},{renderItem:s(({item:e})=>[i(V,null,{default:s(()=>[i(b,{hoverable:"",onClick:d=>z(e),bodyStyle:{padding:"12px 16px"}},{default:s(()=>[f("div",W,[f("div",X,[i(h(x),{style:{"font-size":"18px",color:"#1890ff","margin-right":"8px","flex-shrink":"0"}}),f("span",Y,g(e.id),1)]),i(h(L),{style:{"font-size":"16px",color:"#8c8c8c","flex-shrink":"0"}})])]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data-source"])]),_:1}),a.value?(l(),_(N,{key:0,open:o.value,"onUpdate:open":r[1]||(r[1]=e=>o.value=e),title:`配置适配器 - ${a.value.id}`,width:"500",placement:"right"},{footer:s(()=>[f("div",ne,[i(u,{style:{"margin-right":"8px"},onClick:r[0]||(r[0]=e=>o.value=!1)},{default:s(()=>[...r[3]||(r[3]=[k("取消",-1)])]),_:1}),i(u,{type:"primary",onClick:C},{default:s(()=>[...r[4]||(r[4]=[k("保存配置",-1)])]),_:1})])]),default:s(()=>[a.value.description?(l(),y("div",Z,g(a.value.description),1)):v("",!0),!a.value.configSchema||a.value.configSchema.length===0?(l(),y("div",K,[i(U,{description:"该适配器没有可配置项"})])):(l(),_(E,{key:2,layout:"vertical"},{default:s(()=>[(l(!0),y(J,null,G(a.value.configSchema,e=>(l(),_(B,{key:e.key,label:e.label,required:e.required},{default:s(()=>[e.type==="string"?(l(),_(H,{key:0,value:t[e.key],"onUpdate:value":d=>t[e.key]=d,placeholder:e.placeholder},null,8,["value","onUpdate:value","placeholder"])):v("",!0),e.type==="number"?(l(),_(j,{key:1,value:t[e.key],"onUpdate:value":d=>t[e.key]=d,min:e.min,max:e.max,style:{width:"100%"}},null,8,["value","onUpdate:value","min","max"])):v("",!0),e.type==="boolean"?(l(),y("div",ee,[i(M,{checked:t[e.key],"onUpdate:checked":d=>t[e.key]=d},null,8,["checked","onUpdate:checked"])])):v("",!0),e.type==="select"?(l(),_(P,{key:3,value:t[e.key],"onUpdate:value":d=>t[e.key]=d,options:e.options},null,8,["value","onUpdate:value","options"])):v("",!0),e.note?(l(),y("div",te,g(e.note),1)):v("",!0)]),_:2},1032,["label","required"]))),128))]),_:1}))]),_:1},8,["open","title"])):v("",!0)]),_:1})}}};export{oe as default};
